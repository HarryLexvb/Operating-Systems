functional but has an error in reading files
